<template>
    <VsContainer
        data-test="vs-main-map-wrapper"
    >
        <VsRow>
            <VsCol>
                <section
                    class="vs-main-map-wrapper"
                >
                    <div
                        class="vs-main-map-wrapper__side-panel"
                        :class="panelDisplayClass"
                        data-test="vs-main-map-wrapper__side-panel"
                    >
                        <VsMainMapWrapperPanel
                            @close-panel="closePanel"
                        >
                            <template slot="closePanelText">
                                <slot name="closeSidePanelText" />
                            </template>
                        </VsMainMapWrapperPanel>
                    </div>
                    <div
                        class="vs-main-map-wrapper__map"
                        :class="mapDisplayClass"
                    >
                        <VsButton
                            class="vs-main-map-wrapper__map-toggle"
                            icon-only
                            icon="bars-mobile-menu"
                            size="md"
                            variant="transparent"
                            @click.native="openPanel"
                        >
                            <span class="sr-only">
                                <slot name="openMapText" />
                            </span>
                        </VsButton>
                        <VsMap
                            :labels="{
                            }"
                            :pins="[
                            ]"
                        />
                    </div>
                </section>
            </VsCol>
        </VsRow>
    </VsContainer>
</template>

<script>
import {
    VsContainer,
    VsRow,
    VsCol,
} from '@components/elements/grid';
import VsMap from '@components/elements/map/Map';
import VsButton from '@components/elements/button/Button/';
import VsMainMapWrapperPanel from './components/MainMapWrapperPanel';

/**
 * Renders a widget that display a map
 * and gives filtering options
 *
 * @displayName Main Map Wrapper
 */

export default {
    name: 'VsMainMapWrapper',
    status: 'prototype',
    release: '0.0.1',
    components: {
        VsContainer,
        VsRow,
        VsCol,
        VsMap,
        VsMainMapWrapperPanel,
        VsButton,
    },
    data() {
        return {
            panelVisible: false,
        };
    },
    computed: {
        mapDisplayClass() {
            return this.panelVisible ? 'd-none d-md-block' : '';
        },
        panelDisplayClass() {
            return this.panelVisible ? '' : 'd-none d-md-block';
        },
    },
    mounted() {
        this.panelVisible = true;
    },
    methods: {
        /**
         * Close the side panel
         */
        closePanel() {
            this.panelVisible = false;
        },
        /**
         * Open the side panel
         */
        openPanel() {
            this.panelVisible = true;
        },
    },
};
</script>

<style lang="scss">
    .vs-main-map-wrapper {
        height: 100vh;
        display: flex;

        @include media-breakpoint-up(md) {
            height: 500px;
        }

        .container,
        .row {
            height: 100%;
        }

        &__side-panel {
            width: 490px;
        }

        &__map {
            height: 100%;
            width: 100%;
        }

        &__map-toggle.vs-button {
            background: $color-white;
            position: absolute;
            top: $spacer-4;
            left: $spacer-4;
            z-index: 1;

            @include media-breakpoint-up(md) {
                display: none;
            }
        }
    }
</style>
